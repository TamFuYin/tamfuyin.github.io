---
layout: default
title: 语言学
permalink: /blog/yu-yan-xue/
---


# 语言学

## 题目描述

小 T 喜欢语言学，他最近正在研究古汉语的演变过程。

汉语族由若干方言组成，无论哪种方言，都包含 $n$ 个核心语素，编号为 $1\sim n$。每个方言的每个核心语素的读音可以用一个非负整数表示。

初始时候，只存在一种方言——上古汉语，编号为 $1$，且第 $i$ 个核心语素的读音为 $a_i$。

他发现每个时间点古汉语会发生如下 3 种变化

- $1\ u\ x\ v_1\ v_2\ ...\ v_x$，表示由于移民或战争的影响，方言 $u$ 分裂成 $x$ 种方言，编号为 $v_1,v_2,\dots,v_x$，核心语素的读音不发生变化。同时 $u$ 变为死语言，即后面操作不再出现 $u$。
- $2\ u\ l\ r\ v$，表示方言 $u$ 的部分核心语素发生*元音高化*，形式化地，在方言 $u$ 中，对于 $\forall l\le i\le r,a_i\gets a_i+v$。
- $3\ u\ l\ r\ k$，表示方言 $u$ 的部分核心语素发生*辅音变化*，形式化地，在方言 $u$ 中，对于 $\forall l\le i\le r,a_i\gets a_i\oplus k$，其中 $\oplus$ 表示按位异或。
- $4\ u\ l \ r\ v$，表示方言 $u$ 的部分核心语素发生*韵尾合流*，形式化地，在方言 $u$ 中，对于 $\forall l\le i\le r,a_i\gets \min(a_i,v)$。

小 T 还想知道某种方言的读音

- $5\ u\ i$，表示你需要回答方言 $u$ 的第 $i$ 个核心语素的读音。

## 输入格式

第一行两个正整数 $n,q$，表示方言 $1$ 的核心语素个数和操作个数。

接下来一行 $n$ 个非负整数 $a_1,a_2,\dots,a_n$，表示方言 $1$ 的核心语素的读音。

接下来 $q$ 行操作，每行操作的格式如题目所示。

## 输出格式

对于每个 $5\ u\ i$ 操作，输出方言 $u$ 的第 $i$ 个核心语素的读音。

## 输入输出样例

#### 输入 #1

```
1 2
1
2 1 1 1 1
4 1 1
```

#### 输出 #1

```
2
```

## 说明/提示

对于全部数据 $1\le n,q\le 10^5,\sum x\le 10^5,0\le a_i,v\le 10^9,1\le l\le r\le n,0\le k<8$，保证每次操作的 $u$ 存在。