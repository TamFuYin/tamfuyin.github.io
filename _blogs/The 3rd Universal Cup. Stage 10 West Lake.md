---
layout: default
title: The 3rd Universal Cup. Stage 10 West Lake
permalink: /blog/the-3rd-universal-cup-stage-10-west-lake/
---

# The 3rd Universal Cup. Stage 10: West Lake

## Italian Cuisine

不做

## Generated String

考虑找出所有出现的串，离线造一个数据结构，然后动态插入查询即可。

我们想要知道目前 $\mathbb A$ 中所有串与询问串的 LCP 和 LCS 信息，不妨维护一个前缀 Trie 和后缀 Trie，并得到每个串的 DFS 序，则问题转化为动态二维数点，即「三维偏序」，CDQ 解决即可。

但是问题在于我们不可能显式的建出所有串，而且 Trie 的大小过大。

考虑用类似「后缀树」的技巧，得到一个压缩 Trie，即缩掉所有的二度点。

那么我们在压缩 Trie 上，维护一个所有串的 LCP，然后进入不同分支。

考虑用一个多指针(?)状物维护当前这个东西匹配到哪个地方。

具体地，考虑固定一个串，然后查询其他串剩余未匹配部分与其的 LCP，如果找到 LCP=0 的串，就需要新开一个<ruby>分支<rt>兄弟</rt></ruby>。

在 $S$ 上建一个 SA+ST 辅助完成 LCP 查询即可。

## Permutation

考虑左边全部填 $1$，右边全部填 $2$。

如果答案是 $0$ 或者 $2$，那么很好。

否则，我们知道 $1$ 和 $2$ 在同一个区间内。貌似做不了。

注意到交互器是非适应性的，所以考虑随机化。

每次随两个数 $x$ 和 $y$，则在同一个区间的概率为 $1/2$。

这样就做完了。

## Collect the Coins

考虑二分答案，则可以线性 check。

注意到两个机器人在任意时刻的可能的位置集合都形如一段区间。

## Normal Friends

区间 $[1,x]$ 的翻转操作，等价于找到第 $x$ 个叶子，然后对 $x$ 到根的路径上所有点的左子树整体翻转，且内部翻转。

考虑用 LCT 维护，则只要 access 之后对其左儿子列表翻转即可。

果然还是太有难度了。

## Triangle

设 $(x,y,z)$ 中字典序最大的为 $x$，则 $xy>z$ 和 $xz>y$ 一定成立，如果 $yz>x$，显然这需要 $y$ 为 $x$ 的前缀且 $z>x/y$。

不妨令 $yz>zy$，这等价于 $y^*>z^*$，所以可以按照 $s_i^*$ 排序。

## Stop the Castle 2

转化为选 $m-k$ 个障碍物，隔开尽可能多的车。

考虑把一对相邻的车看作一个元素，那么一个障碍物可以覆盖最多两个点，因此不妨把它看作一条边，则转化为最小点覆盖问题。特别地，如果只覆盖一个点，可以新建一个点然后连一下。

注意到我们可以把横着摆的一对车和纵着摆的一对车分开，于是形如二分图最小点覆盖。这样就做完了

## Intersection of Paths

显然交集也是一条路径，合法当且仅当两边挂的子树大小 $\ge k$。

~~考虑从小到大增大 $k$，那么我们每次会拔掉一些不满足条件的点。~~

考虑一个边是合法的，如果它较小的一边的子树大小 $\ge k$。

考虑从大到小减少 $k$，则我们每次会加入一些边，且总是形如一个连通块。

如果不考虑修改，那么我们可以动态维护这个连通块的直径。

否则，我们需要考虑求出经过它/不经过它的最优解。

在树剖线段树上搞一搞，可以做出来

## Find Yourself

注意到树总是合法的。

考虑对树黑白染色，那么可以确定怪物所在点的颜色，不妨假设与根相同。

假设已知怪物在 $x$ 子树内，且颜色与 $x$ 相同。

如何确定其在哪棵子树内？

1. 询问 $x$，如果怪物在 $x$，则直接结束
2. 否则，此时怪物走到了 $x$ 中与 $x$ 颜色不同的点。
3. 询问一棵子树

## Palindromic Polygon

记 $\bm v_i=p_{i+1}-p_i$。

则 $[l,r]$ 的值为