---
layout: default
title: The 3rd Universal Cup. Stage 6 Osijek
permalink: /blog/the-3rd-universal-cup-stage-6-osijek/
---

## A

如果 $(s,x)=1$，那么 $n=1$；

否则几乎必然存在 $a$ 使得 $a$ 与 $s-a$ 与 $x$ 互质。

## B

怎么感觉有点氵

## C

众所周知子集和问题可以用 bitset 解决 ~~，但是既然题目都这样说了，那肯定不是 bitset，因为过不了~~

现在我们想要对 $a$ 进行赋值，以使尽量多的 $b$ 合法。

如何用加法覆盖所有数？考虑二进制，每一位放一个 $2^x$ 即可。

然而我们只能放 $5000$ 个数，不可能覆盖每一个叶子的每一位。

但是已经足够了。

我们可以只覆盖前 $10$ 位，然后后 $11$ 位做 bitset 即可。

## D

是不是并查集就做完了？

## E

这啥？

## F

大概是形如💥的图形。

貌似点数最少的情况是三芒星？共 6 个点。

## G

离线，按斜率排序，然后就是 KTT 板子。

## H

显然这样的图是一个由若干有向环组成的图，把它看作排列计数问题。

那么相当于：如果 $s_i=0$，那么要求 $p_i<i$；否则，仅要求 $p_i\ne i$，的排列数。

然后就可以 DP 了！

不妨从右往左 DP，设 DP 到 $i$，且目前 $i\sim n$ 还剩下 $j$ 个空位的方案数是 $f_{i,j}$。

那么，如果 $s_i=1$
$$
f_{i,j}=jf_{i+1,j}+(i-1-((n-i)-(j-1)))f_{i+1,j-1}
$$
否则，
$$
f_{i,j}=(i-1-((n-i)-(j-1)))f_{i+1,j-1}
$$

~~其实从左往右也可以~~

## I

~~这个算法不是对的吗~~

哦哦只要让凹多边形的一个内角碰一下这条射线就行了。

可以构造 $(-1,-1),(0,1),(1,0)$，剩下一个点在 $x+y>1$ 上。

## J

首先可以打表发现，一个石子堆能够表示出的 $a_i\text{ xor }(a_i-x)$ 是 $[\text{lowbit}(a_i),2\times \text{highbit}(a_i)-1]$。

如果 highbit 只有两个，那么我们可以把其中一个异或上 $[\text{highbit},2\times \text{highbit}-1]$。

如果 lowbit 只有两个，那么我们可以把其中一个异或上 $[\text{lowbit},2\times \text{lowbit}-1]$。

否则好像就没有别的解了？

你发现我们可以操控另外一个在操作完之后变成什么，而我们期望它能够继续操作。

关注次高位，如果不止两个，那么我们貌似不能对它消去，只能通过最低位进行消去。

所以合法当且仅当，石堆可以两两配对，且每对都存在一位，使其只有这一对有 $1$，其它都没有？

## K

这不肯定可以吗？

所以就是动态凸包板子？每次取（横坐标，纵坐标）最小点即可

## L

~~我操这个回转寿司怎么这么坏啊~~

如果当前桌面的菜加上这个菜不超过 $1000$，那么直接放进来即可；

否则，如果有办法通过舍弃部分菜再加上这个菜以达到 $600$，就这样操作，然后后面就可以摆烂了。

否则，我们断言现在所有的菜都必然 $>400$，也就是说，当前桌面上必然只有一个 $(400,600)$ 之间的菜，我们在两个菜之间如何抉择？

如果现在的这个菜 $\ge 600$，就只吃这个就好了。所以两个菜可能的范围都是 $(400,600)$。

注意到 $600\times 0.6=360<400$，所以选较小的那个没什么影响。