---
layout: default
title: The 3rd Universal Cup. Stage 7 Warsaw
permalink: /blog/the-3rd-universal-cup-stage-7-warsaw/
---

## A

DP 套 DP。

内层最优化 DP：

$$
f_i=\min(f_{\min j:t_j+a_1\ge t_i}+b_1,f_{\min j:t_j+a_2\ge t_i}+b_2)
$$

外层计数 DP：$g_{i,j}=\#\{f_i=j\}$

显然状态数是 $O(N^2)$ 级别的。

## B

这不噗叽组题吗

## C

不妨按照 $a$ 从大到小排序。

如果 $b$ 也是有序的，那么可以设计一个 $O(N)$ 的 DP。

但是它是乱序的，我们还需要一些「性质」。

如果 $a_i>a_j$ 且 $b_i<b_j$，那么一定不会让 $i\in A$ 而 $j\in B$，这是因为调整之后不会更劣。

这意味着什么？

为了观察，我们不妨把它放到一个二维平面上。我们发现必然存在一条从 $(0,0)$ 到 $(+\infin,+\infin)$ 的折线，使其左上角是 $A$，右下角是 $B$。

然后就可以 DP 了。

设 $f_{i,j}$ 表示 $a$ 坐标走到 $i$，$b$ 坐标走到 $j$ 的最小代价。

然后可以用线段树维护。

## D

这不噗叽组题吗

## E

分层图最短路

## F

我们注意到 Fibonacci 数列是指数增长的。

所以只需要处理前 $O(2\times 10^6)$ 项即可获得所有所需的 Fibonacci 数列，而处理这一过程的复杂度也是 $O(2\times 10^6)$ 的。

我们可以处理出每个 $a_i$ 夹在哪两个 Fibonacci 数之间。

可以发现一个 $a_i$ 最多向两个 Fibonacci 数贡献，用一个 hash 统计贡献即可。

## G

显然先手一定划掉最小数所在行，后手一定划掉最大数所在列。

如何证明？

## H

分讨题

## I

大分讨

首先对能够靠「通过题目数」进行区分的 $(a,b,c)$ 进行计数

剩下的分讨

## J

数据这么小，直接枚举第一段 $1$ 和最后一段 $1$ 即可。

## K

首先注意到不能有环。所以这是树。

如果我们能找到一个根，那么一定得形如一棵字典树，所以这是一棵二叉树。

注意到权值是 $\sum_i[deg_i=3\lor (deg_i=2\land i=rt)]2^{dep_i}\min(siz_{ls_i},siz_{rs_i})$。

可以换根 DP？

## L

考虑前缀和

$$
s_l=s_r-(r-l)^2
$$

考虑扫描线，那么相当于加上
$$
-(r-l)^2+(r-l+1)^2=2(r-l)
$$

即区间减一个等差数列，然后数等于某个数的元素的个数。

凭直觉，答案应该很少，所以可以维护一下最大值最小值直接进去搜索？

并非。

注意到答案要么长度比较短（$\le 20$），要么比较接近 $n/2$。

## M

答案是所有大小为 $2$ 的整数次幂的集合中和的最大值。

排序即可